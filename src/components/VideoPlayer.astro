---
export interface Props {
  src: string;
  poster?: string;
  width?: string;
  height?: string;
  autoplay?: boolean;
  muted?: boolean;
  loop?: boolean;
  controls?: boolean;
  class?: string;
}

const {
  src,
  poster,
  width = "100%",
  height = "auto",
  autoplay = false,
  muted = false,
  loop = false,
  controls = true,
  class: className = ""
} = Astro.props;

// Get file extension to determine type
const extension = src.split('.').pop()?.toLowerCase();
const getVideoType = (ext: string) => {
  switch (ext) {
    case 'mp4':
      return 'video/mp4';
    case 'mov':
      return 'video/quicktime';
    case 'webm':
      return 'video/webm';
    case 'ogg':
      return 'video/ogg';
    default:
      return 'video/mp4';
  }
};
---

<div class={`video-container ${className}`}>
  <video
    width={width}
    height={height}
    controls={controls}
    autoplay={autoplay}
    muted={muted}
    loop={loop}
    poster={poster}
    style="border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);"
  >
    <source src={src} type={getVideoType(extension || 'mp4')}>
    Your browser does not support the video tag.
  </video>
</div>

<style>
  .video-container {
    margin: 1.5rem 0;
    text-align: center;
  }
  
  video {
    max-width: 100%;
    height: auto;
  }
  
  @media (max-width: 768px) {
    video {
      width: 100%;
    }
  }
</style>
